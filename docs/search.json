[
  {
    "objectID": "homework 8.html",
    "href": "homework 8.html",
    "title": "ST558 Homework 8",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\ntemp_data &lt;- read_csv(\"SeoulBikeData.csv\", col_names = TRUE, locale = locale(encoding=\"latin1\"))\n\nRows: 8760 Columns: 14\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (4): Date, Seasons, Holiday, Functioning Day\ndbl (10): Rented Bike Count, Hour, Temperature(°C), Humidity(%), Wind speed ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message."
  },
  {
    "objectID": "homework 8.html#reading-in-the-data",
    "href": "homework 8.html#reading-in-the-data",
    "title": "ST558 Homework 8",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\ntemp_data &lt;- read_csv(\"SeoulBikeData.csv\", col_names = TRUE, locale = locale(encoding=\"latin1\"))\n\nRows: 8760 Columns: 14\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (4): Date, Seasons, Holiday, Functioning Day\ndbl (10): Rented Bike Count, Hour, Temperature(°C), Humidity(%), Wind speed ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message."
  },
  {
    "objectID": "homework 8.html#checking-the-data",
    "href": "homework 8.html#checking-the-data",
    "title": "ST558 Homework 8",
    "section": "Checking the Data",
    "text": "Checking the Data\n\nstr(temp_data)  # checking column types\n\nspc_tbl_ [8,760 × 14] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ Date                     : chr [1:8760] \"01/12/2017\" \"01/12/2017\" \"01/12/2017\" \"01/12/2017\" ...\n $ Rented Bike Count        : num [1:8760] 254 204 173 107 78 100 181 460 930 490 ...\n $ Hour                     : num [1:8760] 0 1 2 3 4 5 6 7 8 9 ...\n $ Temperature(°C)          : num [1:8760] -5.2 -5.5 -6 -6.2 -6 -6.4 -6.6 -7.4 -7.6 -6.5 ...\n $ Humidity(%)              : num [1:8760] 37 38 39 40 36 37 35 38 37 27 ...\n $ Wind speed (m/s)         : num [1:8760] 2.2 0.8 1 0.9 2.3 1.5 1.3 0.9 1.1 0.5 ...\n $ Visibility (10m)         : num [1:8760] 2000 2000 2000 2000 2000 ...\n $ Dew point temperature(°C): num [1:8760] -17.6 -17.6 -17.7 -17.6 -18.6 -18.7 -19.5 -19.3 -19.8 -22.4 ...\n $ Solar Radiation (MJ/m2)  : num [1:8760] 0 0 0 0 0 0 0 0 0.01 0.23 ...\n $ Rainfall(mm)             : num [1:8760] 0 0 0 0 0 0 0 0 0 0 ...\n $ Snowfall (cm)            : num [1:8760] 0 0 0 0 0 0 0 0 0 0 ...\n $ Seasons                  : chr [1:8760] \"Winter\" \"Winter\" \"Winter\" \"Winter\" ...\n $ Holiday                  : chr [1:8760] \"No Holiday\" \"No Holiday\" \"No Holiday\" \"No Holiday\" ...\n $ Functioning Day          : chr [1:8760] \"Yes\" \"Yes\" \"Yes\" \"Yes\" ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   Date = col_character(),\n  ..   `Rented Bike Count` = col_double(),\n  ..   Hour = col_double(),\n  ..   `Temperature(°C)` = col_double(),\n  ..   `Humidity(%)` = col_double(),\n  ..   `Wind speed (m/s)` = col_double(),\n  ..   `Visibility (10m)` = col_double(),\n  ..   `Dew point temperature(°C)` = col_double(),\n  ..   `Solar Radiation (MJ/m2)` = col_double(),\n  ..   `Rainfall(mm)` = col_double(),\n  ..   `Snowfall (cm)` = col_double(),\n  ..   Seasons = col_character(),\n  ..   Holiday = col_character(),\n  ..   `Functioning Day` = col_character()\n  .. )\n - attr(*, \"problems\")=&lt;externalptr&gt; \n\nsummary(temp_data)  # checking summary stats on numeric columns\n\n     Date           Rented Bike Count      Hour       Temperature(°C) \n Length:8760        Min.   :   0.0    Min.   : 0.00   Min.   :-17.80  \n Class :character   1st Qu.: 191.0    1st Qu.: 5.75   1st Qu.:  3.50  \n Mode  :character   Median : 504.5    Median :11.50   Median : 13.70  \n                    Mean   : 704.6    Mean   :11.50   Mean   : 12.88  \n                    3rd Qu.:1065.2    3rd Qu.:17.25   3rd Qu.: 22.50  \n                    Max.   :3556.0    Max.   :23.00   Max.   : 39.40  \n  Humidity(%)    Wind speed (m/s) Visibility (10m) Dew point temperature(°C)\n Min.   : 0.00   Min.   :0.000    Min.   :  27     Min.   :-30.600          \n 1st Qu.:42.00   1st Qu.:0.900    1st Qu.: 940     1st Qu.: -4.700          \n Median :57.00   Median :1.500    Median :1698     Median :  5.100          \n Mean   :58.23   Mean   :1.725    Mean   :1437     Mean   :  4.074          \n 3rd Qu.:74.00   3rd Qu.:2.300    3rd Qu.:2000     3rd Qu.: 14.800          \n Max.   :98.00   Max.   :7.400    Max.   :2000     Max.   : 27.200          \n Solar Radiation (MJ/m2)  Rainfall(mm)     Snowfall (cm)       Seasons         \n Min.   :0.0000          Min.   : 0.0000   Min.   :0.00000   Length:8760       \n 1st Qu.:0.0000          1st Qu.: 0.0000   1st Qu.:0.00000   Class :character  \n Median :0.0100          Median : 0.0000   Median :0.00000   Mode  :character  \n Mean   :0.5691          Mean   : 0.1487   Mean   :0.07507                     \n 3rd Qu.:0.9300          3rd Qu.: 0.0000   3rd Qu.:0.00000                     \n Max.   :3.5200          Max.   :35.0000   Max.   :8.80000                     \n   Holiday          Functioning Day   \n Length:8760        Length:8760       \n Class :character   Class :character  \n Mode  :character   Mode  :character  \n                                      \n                                      \n                                      \n\n## checking categorical variable values except date\nunique(temp_data$Seasons)\n\n[1] \"Winter\" \"Spring\" \"Summer\" \"Autumn\"\n\nunique(temp_data$Holiday)\n\n[1] \"No Holiday\" \"Holiday\"   \n\nunique(temp_data$`Functioning Day`)\n\n[1] \"Yes\" \"No\" \n\n\n\nbike_data &lt;- temp_data |&gt;\n  drop_na() |&gt;  # removes any rows with missing values (there are none)\n  mutate(Date = dmy(Date)) |&gt;  # converts date column to date variable\n  mutate(across(where(is.character), as.factor))  # converts all other character columns into factors\n\n## renaming all variables\nbike_names &lt;- c(\"date\", \"count\", \"hour\", \"temp\", \"humidity\", \"windspeed\", \"visibility\", \"dewpoint\", \"radiation\", \"rainfall\",\n                \"snowfall\", \"season\", \"holiday\", \"funcday\")\n\nnames(bike_data) &lt;- bike_names\n\n\n## creating summary statistics\nbike_data |&gt;\n  group_by(season, holiday, funcday) |&gt;\n  summarize(mean = mean(count, na.rm = TRUE), \n                 sd = sd(count, na.rm = TRUE))\n\n`summarise()` has grouped output by 'season', 'holiday'. You can override using\nthe `.groups` argument.\n\n\n# A tibble: 11 × 5\n# Groups:   season, holiday [8]\n   season holiday    funcday  mean    sd\n   &lt;fct&gt;  &lt;fct&gt;      &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;\n 1 Autumn Holiday    No         0     0 \n 2 Autumn Holiday    Yes      948.  603.\n 3 Autumn No Holiday No         0     0 \n 4 Autumn No Holiday Yes      923.  618.\n 5 Spring Holiday    Yes      635.  609.\n 6 Spring No Holiday No         0     0 \n 7 Spring No Holiday Yes      750.  619.\n 8 Summer Holiday    Yes     1022.  564.\n 9 Summer No Holiday Yes     1034.  693.\n10 Winter Holiday    Yes      157.  108.\n11 Winter No Holiday Yes      232.  152.\n\n## count is 0 when funcday = No, removing from data\nbike_data &lt;- bike_data |&gt;\n  filter(funcday != \"No\")\n\n\n## final summary\nsum_data &lt;- bike_data |&gt;\n  group_by(date, season, holiday) |&gt;\n  summarize(count = sum(count, na.rm = TRUE),\n            rainfall = sum(rainfall, na.rm = TRUE),\n            snowfall = sum(snowfall, na.rm = TRUE),\n            across(where(is.numeric) & !c(count, hour), mean, na.rm = TRUE)\n            )\n\nWarning: There was 1 warning in `summarize()`.\nℹ In argument: `across(where(is.numeric) & !c(count, hour), mean, na.rm =\n  TRUE)`.\nℹ In group 1: `date = 2017-12-01`, `season = Winter`, `holiday = No Holiday`.\nCaused by warning:\n! The `...` argument of `across()` is deprecated as of dplyr 1.1.0.\nSupply arguments directly to `.fns` through an anonymous function instead.\n\n  # Previously\n  across(a:b, mean, na.rm = TRUE)\n\n  # Now\n  across(a:b, \\(x) mean(x, na.rm = TRUE))\n\n\n`summarise()` has grouped output by 'date', 'season'. You can override using\nthe `.groups` argument.\n\nsum_data\n\n# A tibble: 353 × 12\n# Groups:   date, season [353]\n   date       season holiday  count rainfall snowfall    temp humidity windspeed\n   &lt;date&gt;     &lt;fct&gt;  &lt;fct&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n 1 2017-12-01 Winter No Holi…  9539      0        0   -2.45       45.9     1.54 \n 2 2017-12-02 Winter No Holi…  8523      0        0    1.32       62.0     1.71 \n 3 2017-12-03 Winter No Holi…  7222      4        0    4.88       81.5     1.61 \n 4 2017-12-04 Winter No Holi…  8729      0.1      0   -0.304      52.5     3.45 \n 5 2017-12-05 Winter No Holi…  8307      0        0   -4.46       36.4     1.11 \n 6 2017-12-06 Winter No Holi…  6669      1.3      8.6  0.0458     70.8     0.696\n 7 2017-12-07 Winter No Holi…  8549      0       10.4  1.09       67.5     1.69 \n 8 2017-12-08 Winter No Holi…  8032      0        0   -3.82       41.8     1.85 \n 9 2017-12-09 Winter No Holi…  7233      0        0   -0.846      46       1.08 \n10 2017-12-10 Winter No Holi…  3453      4.1     32.5  1.19       69.7     2.00 \n# ℹ 343 more rows\n# ℹ 3 more variables: visibility &lt;dbl&gt;, dewpoint &lt;dbl&gt;, radiation &lt;dbl&gt;\n\n\n\n## recreating summary stats on new data\nsum_data |&gt;\n  group_by(season, holiday) |&gt;\n  summarize(across(where(is.numeric),\n                   list(\"mean\" = ~ mean(.x, na.rm = TRUE), \"sd\" = ~ sd(.x, na.rm = TRUE)),\n                   .names = \"{.fn}_{.col}\"))\n\n`summarise()` has grouped output by 'season'. You can override using the\n`.groups` argument.\n\n\n# A tibble: 8 × 20\n# Groups:   season [4]\n  season holiday    mean_count sd_count mean_rainfall sd_rainfall mean_snowfall\n  &lt;fct&gt;  &lt;fct&gt;           &lt;dbl&gt;    &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;\n1 Autumn Holiday        22754.    5642.         0           0              0   \n2 Autumn No Holiday     22065.    6792.         2.96        8.81           1.60\n3 Spring Holiday        15247.   10917.         3.83        4.65           0   \n4 Spring No Holiday     18002.    8322.         4.51       12.9            0   \n5 Summer Holiday        24532.    8438.         0.5         0.707          0   \n6 Summer No Holiday     24824.    7324.         6.21       17.2            0   \n7 Winter Holiday         3759     1561.         2.65        7.02           2.75\n8 Winter No Holiday      5574.    1757.         0.606       2.68           6.25\n# ℹ 13 more variables: sd_snowfall &lt;dbl&gt;, mean_temp &lt;dbl&gt;, sd_temp &lt;dbl&gt;,\n#   mean_humidity &lt;dbl&gt;, sd_humidity &lt;dbl&gt;, mean_windspeed &lt;dbl&gt;,\n#   sd_windspeed &lt;dbl&gt;, mean_visibility &lt;dbl&gt;, sd_visibility &lt;dbl&gt;,\n#   mean_dewpoint &lt;dbl&gt;, sd_dewpoint &lt;dbl&gt;, mean_radiation &lt;dbl&gt;,\n#   sd_radiation &lt;dbl&gt;\n\n\n\n## basic plots\nggplot(sum_data, aes(x = count, fill = season)) +\n  geom_boxplot() +\n  labs(x = \"Number of Bikes Rented\", fill = \"Season\")\n\n\n\n\n\n\n\n\n\nggplot(sum_data, aes(x = count, y = humidity)) +\n  geom_point()\n\n\n\n\n\n\n\n\n\nggplot(sum_data, aes(x = date, y = count)) +\n  geom_line() +\n  labs(x = \"Date\", y = \"Number of Bikes Rented\")\n\n\n\n\n\n\n\n\n\n## correlation between numerical variables\nsum_data |&gt;\n  ungroup() |&gt;\n  select(where(is.numeric)) |&gt;\n  cor()\n\n                 count    rainfall    snowfall         temp    humidity\ncount       1.00000000 -0.23910905 -0.26529110  0.753076732  0.03588697\nrainfall   -0.23910905  1.00000000 -0.02313404  0.144517274  0.52864263\nsnowfall   -0.26529110 -0.02313404  1.00000000 -0.266963662  0.06539191\ntemp        0.75307673  0.14451727 -0.26696366  1.000000000  0.40416749\nhumidity    0.03588697  0.52864263  0.06539191  0.404167486  1.00000000\nwindspeed  -0.19288142 -0.10167578  0.02088156 -0.260721792 -0.23425778\nvisibility  0.16599375 -0.22199387 -0.10188902  0.002336683 -0.55917733\ndewpoint    0.65047655  0.26456621 -0.20955286  0.962796255  0.63204729\nradiation   0.73589290 -0.32270413 -0.23343056  0.550274301 -0.27444967\n             windspeed   visibility   dewpoint   radiation\ncount      -0.19288142  0.165993749  0.6504765  0.73589290\nrainfall   -0.10167578 -0.221993866  0.2645662 -0.32270413\nsnowfall    0.02088156 -0.101889019 -0.2095529 -0.23343056\ntemp       -0.26072179  0.002336683  0.9627963  0.55027430\nhumidity   -0.23425778 -0.559177334  0.6320473 -0.27444967\nwindspeed   1.00000000  0.206022636 -0.2877032  0.09612635\nvisibility  0.20602264  1.000000000 -0.1535516  0.27139591\ndewpoint   -0.28770322 -0.153551591  1.0000000  0.38315713\nradiation   0.09612635  0.271395906  0.3831571  1.00000000"
  },
  {
    "objectID": "homework 8.html#split-the-data",
    "href": "homework 8.html#split-the-data",
    "title": "ST558 Homework 8",
    "section": "Split the Data",
    "text": "Split the Data\n\nlibrary(tidymodels)\n\nWarning: package 'tidymodels' was built under R version 4.4.2\n\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.2.0 ──\n\n\n✔ broom        1.0.6     ✔ rsample      1.2.1\n✔ dials        1.3.0     ✔ tune         1.2.1\n✔ infer        1.0.7     ✔ workflows    1.1.4\n✔ modeldata    1.4.0     ✔ workflowsets 1.1.0\n✔ parsnip      1.2.1     ✔ yardstick    1.3.1\n✔ recipes      1.1.0     \n\n\nWarning: package 'dials' was built under R version 4.4.2\n\n\nWarning: package 'infer' was built under R version 4.4.2\n\n\nWarning: package 'modeldata' was built under R version 4.4.2\n\n\nWarning: package 'parsnip' was built under R version 4.4.2\n\n\nWarning: package 'recipes' was built under R version 4.4.2\n\n\nWarning: package 'rsample' was built under R version 4.4.2\n\n\nWarning: package 'tune' was built under R version 4.4.2\n\n\nWarning: package 'workflows' was built under R version 4.4.2\n\n\nWarning: package 'workflowsets' was built under R version 4.4.2\n\n\nWarning: package 'yardstick' was built under R version 4.4.2\n\n\n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n• Use tidymodels_prefer() to resolve common conflicts.\n\nbike_split &lt;- initial_split(sum_data, 0.75)\nbike_train &lt;- training(bike_split)\nbike_test &lt;- testing(bike_split)\n\n\nbike_10_fold &lt;- vfold_cv(bike_train, 10)"
  },
  {
    "objectID": "homework 8.html#fitting-mlr-models",
    "href": "homework 8.html#fitting-mlr-models",
    "title": "ST558 Homework 8",
    "section": "Fitting MLR Models",
    "text": "Fitting MLR Models\n\n## first recipe\nbike_rec_1 &lt;- \n  recipe(count ~ ., data = sum_data) |&gt;\n  update_role(date, new_role = \"ID\") |&gt;\n  step_date(date, features = \"dow\") |&gt;\n  step_mutate(day_type = factor(if_else(date_dow %in% c(\"Sat\", \"Sun\"), \"weekend\", \"weekday\"))) |&gt;\n  step_rm(date_dow) |&gt;\n  step_normalize(all_numeric(), -all_outcomes()) |&gt;\n  step_dummy(season, holiday, day_type)\n\n\n## second recipe\nbike_rec_2 &lt;- \n  recipe(count ~ ., data = sum_data) |&gt;\n  update_role(date, new_role = \"ID\") |&gt;\n  step_date(date, features = \"dow\") |&gt;\n  step_mutate(day_type = factor(if_else(date_dow %in% c(\"Sat\", \"Sun\"), \"weekend\", \"weekday\"))) |&gt;\n  step_rm(date_dow) |&gt;\n  step_normalize(all_numeric(), -all_outcomes()) |&gt;\n  step_dummy(season, holiday, day_type) |&gt;\n  step_interact(terms = ~starts_with(\"season\")*starts_with(\"holiday\") + temp*rainfall) |&gt;\n  step_interact(terms = ~season_Spring*temp + season_Winter*temp) |&gt;\n  step_interact(terms = ~season_Summer*temp)\n\n\n## third recipe\nbike_rec_3 &lt;- \n  recipe(count ~ ., data = sum_data) |&gt;\n  update_role(date, new_role = \"ID\") |&gt;\n  step_date(date, features = \"dow\") |&gt;\n  step_mutate(day_type = factor(if_else(date_dow %in% c(\"Sat\", \"Sun\"), \"weekend\", \"weekday\"))) |&gt;\n  step_rm(date_dow) |&gt;\n  step_normalize(all_numeric(), -all_outcomes()) |&gt;\n  step_dummy(season, holiday, day_type) |&gt;\n  step_interact(terms = ~starts_with(\"season\")*starts_with(\"holiday\") + temp*rainfall) |&gt;\n  step_interact(terms = ~season_Spring*temp + season_Winter*temp) |&gt;\n  step_interact(terms = ~season_Summer*temp) |&gt;\n  step_poly(rainfall, snowfall, temp, humidity, windspeed, visibility, dewpoint, radiation, degree = 2)\n\n\n## fitting the models\nbike_mod &lt;- linear_reg() |&gt;\n  set_engine(\"lm\")\n\nbike_wfl_1 &lt;- workflow() |&gt;\n  add_recipe(bike_rec_1) |&gt;\n  add_model(bike_mod)\n\nbike_wfl_2 &lt;- workflow() |&gt;\n  add_recipe(bike_rec_2) |&gt;\n  add_model(bike_mod)\n\nbike_wfl_3 &lt;- workflow() |&gt;\n  add_recipe(bike_rec_3) |&gt;\n  add_model(bike_mod)\n\n\nbike_cv_fits_1 &lt;- bike_wfl_1 |&gt;\n  fit_resamples(bike_10_fold)\n\nbike_cv_fits_2 &lt;- bike_wfl_2 |&gt;\n  fit_resamples(bike_10_fold)\n\n→ A | warning: prediction from rank-deficient fit; consider predict(., rankdeficient=\"NA\")\n\n\nThere were issues with some computations   A: x1\nThere were issues with some computations   A: x1\n\n\n\n\nbike_cv_fits_3 &lt;- bike_wfl_3 |&gt;\n  fit_resamples(bike_10_fold)\n\n→ A | warning: prediction from rank-deficient fit; consider predict(., rankdeficient=\"NA\")\n\ncollect_metrics(bike_cv_fits_1)\n\n# A tibble: 2 × 6\n  .metric .estimator     mean     n  std_err .config             \n  &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;               \n1 rmse    standard   4089.       10 243.     Preprocessor1_Model1\n2 rsq     standard      0.826    10   0.0224 Preprocessor1_Model1\n\ncollect_metrics(bike_cv_fits_2)\n\n# A tibble: 2 × 6\n  .metric .estimator     mean     n  std_err .config             \n  &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;               \n1 rmse    standard   3007.       10 300.     Preprocessor1_Model1\n2 rsq     standard      0.905    10   0.0177 Preprocessor1_Model1\n\ncollect_metrics(bike_cv_fits_3)  # lowest RMSE\n\n# A tibble: 2 × 6\n  .metric .estimator     mean     n  std_err .config             \n  &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;               \n1 rmse    standard   2827.       10 247.     Preprocessor1_Model1\n2 rsq     standard      0.914    10   0.0159 Preprocessor1_Model1\n\n\n\n## fitting best model to entire training data set\nbest_fit  &lt;- last_fit(bike_wfl_3, bike_split)\ncollect_metrics(best_fit)\n\n# A tibble: 2 × 4\n  .metric .estimator .estimate .config             \n  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               \n1 rmse    standard    3194.    Preprocessor1_Model1\n2 rsq     standard       0.900 Preprocessor1_Model1\n\nbest_fit |&gt;\n  extract_fit_parsnip() |&gt;\n  tidy()\n\n# A tibble: 29 × 5\n   term                               estimate std.error statistic  p.value\n   &lt;chr&gt;                                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;\n 1 (Intercept)                          16147.     1800.    8.97   9.68e-17\n 2 season_Spring                        -1963.     2621.   -0.749  4.55e- 1\n 3 season_Summer                        17510.     3843.    4.56   8.35e- 6\n 4 season_Winter                        -9577.     2748.   -3.49   5.87e- 4\n 5 holiday_No.Holiday                    5022.     1628.    3.09   2.28e- 3\n 6 day_type_weekend                     -2684.      376.   -7.14   1.12e-11\n 7 season_Spring_x_holiday_No.Holiday   -2066.     2672.   -0.773  4.40e- 1\n 8 season_Summer_x_holiday_No.Holiday    -288.     3199.   -0.0902 9.28e- 1\n 9 season_Winter_x_holiday_No.Holiday   -1911.     1955.   -0.977  3.29e- 1\n10 temp_x_rainfall                      -1480.      498.   -2.97   3.26e- 3\n# ℹ 19 more rows"
  }
]